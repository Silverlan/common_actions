name: 'Get zlib'
description: 'Downloads the zlib library'
inputs:
  cmake_definitions:
    description: 'CMake definitions'
    required: true
    default: 'external_libs'
  cmake_var:
    description: 'Name of the CMake variable to set to the include path'
    required: true
    default: ''
runs:
  using: "composite"
  steps: 
    - name: Initialize Env
      id: init-env
      uses: Silverlan/common_actions/set_common_env_vars@main
      
    - name: Build submodule - zlib
      uses: Silverlan/common_actions/build_submodule@main
      with:
        repo: 'https://github.com/madler/zlib.git'
        repo_name: 'zlib'
        repo_branch: 'master'
        build_target_windows: zlib
        build_target_linux: z
        cmake_var: 'ZLIB_INCLUDE_DIR'
        cmake_var_alias: 'DEPENDENCY_ZLIB_INCLUDE'
        cmake_var_lib: 'ZLIB_LIBRARY'
        cmake_var_lib_alias: 'DEPENDENCY_ZLIB_LIBRARY'
        include_dir: '.'
    - name: Copy zconf.h
      shell: bash
      run: |
        cp -n ./build/third_party_libs/zlib/zconf.h ./third_party_libs/zlib/zconf.h
      
